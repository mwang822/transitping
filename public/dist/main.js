(()=>{const t=document.getElementById("transitResponse"),n=document.getElementById("status");function e(t,n){const e=new URLSearchParams;return e.append("wayPoint.1",`${t.lat},${t.lon}`),e.append("wayPoint.2",`${n.lat},${n.lon}`),e.append("ra","routeSummariesOnly"),e.append("key","AgABNf69TNOhfktEdaM_VXgsALbx4Rt4ih00qLabWszbrukFBCOS_LSDD1iZRWar"),fetch(`https://dev.virtualearth.net/REST/v1/Routes/walking?${e.toString()}`)}(async function(){let o=await new Promise((function(t,n){navigator.geolocation.getCurrentPosition(t,n)})),a=await function(t){const n=new URLSearchParams;return n.append("lat",t.lat),n.append("lon",t.lon),fetch(`https://transitping-mtapi.onrender.com/by-location?${n.toString()}`)}({lat:o.coords.latitude,lon:o.coords.longitude}),s=await a.json();s=s.data;let i="";for(let t=0;t<3;t++){let n,a,l={},u={};n=s[t].N,a=s[t].S,walkTimeRes=await e({lat:o.coords.latitude,lon:o.coords.longitude},{lat:s[t].location[0],lon:s[t].location[1]});let p=await walkTimeRes.json(),d=Math.round(p.resourceSets[0].resources[0].travelDuration/60);i+=`<div class="station ${s[t].name.toLowerCase().replace(/\s+/g,"-")}>`,i+=`<p class="station-name">${s[t].name}&nbsp;&nbsp;&nbsp;&nbsp;&#128694;${d}mins</p>`,i+='<div class="direction north">',i+="<p>Northbound Trains</p>";for(let e=0;e<Math.min(4,n.length);e++){let o=Math.round((new Date(n[e].time)-Date.now())/6e4);s[t].N[e].route in l?l[s[t].N[e].route].push(o):l[s[t].N[e].route]=[o]}for(var r in l){let t="";for(let n=0;n<l[r].length;n++)t+=`${l[r][n]}, `;t=t.substring(0,t.length-2),i+=`<p>Route: ${r}&nbsp;&nbsp;&nbsp;ETA: ${t} mins</p>`}i+="</div>",i+='<div class="direction south">',i+="<p>Southbound Trains</p>";for(let t=0;t<Math.min(4,a.length);t++){let n=Math.round((new Date(a[t].time)-Date.now())/6e4);a[t].route in u?u[a[t].route].push(n):u[a[t].route]=[n]}for(var r in u){let t="";for(let n=0;n<u[r].length;n++)t+=`${u[r][n]}, `;t=t.substring(0,t.length-2),i+=`<p>Route: ${r}&nbsp;&nbsp;&nbsp;ETA: ${t} mins</p>`}i+="</div>",i+="</div>"}n.remove(),t.innerHTML=`<div class="stations">${i}</div>`})().catch((t=>n.innerHTML=t))})();